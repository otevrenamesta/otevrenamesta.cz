<template>
  <section>
    <div class="container">
      <h2 class="text-primary font-bold text-4xl mb-1 tracking-tight">
        {{ useContentStore().homepage.projects.title }}
      </h2>
      <nuxt-link
        :to="$localePath('/projects')"
        class="block mb-block-1 xs:mb-block-0.5"
      >
        <Button
          type="transparent"
          icon="icon-arrow-right"
          class="text-secondary px-0"
        >
          {{ useContentStore().homepage.projects.all }}
        </Button>
      </nuxt-link>
    </div>

    <section class="container relative mb-block-6">
      <Grid
        :rows="gridRows"
        class="absolute top-0 left-0 w-full h-full"
      />

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-block-2">
        <HomepageProjectsProject
          v-for="(project, index) in projects"
          :key="index"
          :project="project"
          :illustration="illustrations?.[index % (illustrations?.length)]"
        />
      </div>
    </section>
  </section>
</template>

<script setup>
import { useGrid } from 'vue-screen';

const illustrations = [
  '<svg xmlns="http://www.w3.org/2000/svg" width="765.967" height="648.038" viewBox="0 0 765.967 648.038"><defs><filter id="a" x="0" y="482.557" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-sm"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-sm"/><feComposite in="SourceGraphic"/></filter><filter id="b" x="240.584" y="362.076" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-2"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-2"/><feComposite in="SourceGraphic"/></filter><filter id="c" x="120.481" y="120.86" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-3"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-3"/><feComposite in="SourceGraphic"/></filter><filter id="d" x="359.648" y="241.721" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-4"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-4"/><feComposite in="SourceGraphic"/></filter><filter id="e" x="240.584" y="241.721" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-5"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-5"/><feComposite in="SourceGraphic"/></filter><filter id="f" x="240.836" y="120.861" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-6"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-6"/><feComposite in="SourceGraphic"/></filter><filter id="g" x="480.004" y="241.721" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-7"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-7"/><feComposite in="SourceGraphic"/></filter><filter id="h" x="240.836" y=".379" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-8"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-8"/><feComposite in="SourceGraphic"/></filter><filter id="i" x="600.486" y=".38" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-9"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-9"/><feComposite in="SourceGraphic"/></filter><filter id="j" x="359.523" y="120.86" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-10"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-10"/><feComposite in="SourceGraphic"/></filter><filter id="k" x="120.103" y="241.721" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-11"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-11"/><feComposite in="SourceGraphic"/></filter><filter id="l" x="120.103" y="0" width="165.481" height="165.481" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-12"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-12"/><feComposite in="SourceGraphic"/></filter></defs><g style="isolation:isolate"><g filter="url(#a)" transform="translate(-.003 .004)"><path data-name="Rectangle 527" d="M7.5 490.06h120.481v120.481A120.481 120.481 0 0 1 7.5 490.06Z" fill="#b4c7ff"/></g><g filter="url(#b)" transform="translate(-.003 .004)"><path data-name="Rectangle 528" d="M248.08 490.06V369.579h120.481A120.481 120.481 0 0 1 248.08 490.06Z" fill="#1e1796"/></g><g filter="url(#c)" transform="translate(-.003 .004)"><path data-name="Rectangle 556" d="M127.98 128.36h120.481v120.481A120.481 120.481 0 0 1 127.98 128.36Z" fill="#1e1796"/></g><g filter="url(#d)" transform="translate(-.003 .004)"><path data-name="Rectangle 552" d="M367.15 249.22h120.481v120.481A120.481 120.481 0 0 1 367.15 249.22Z" fill="#1e1796"/></g><g filter="url(#e)" transform="translate(-.003 .004)"><path data-name="Rectangle 529" d="M368.56 369.7H248.079V249.219A120.481 120.481 0 0 1 368.56 369.7Z" fill="#1e1796"/></g><g filter="url(#f)" transform="translate(-.003 .004)"><path data-name="Rectangle 554" d="M248.34 248.84V128.359h120.481A120.481 120.481 0 0 1 248.34 248.84Z" fill="#1e1796"/></g><g filter="url(#g)" transform="translate(-.003 .004)"><path data-name="Rectangle 550" d="M487.5 369.7V249.219h120.481A120.481 120.481 0 0 1 487.5 369.7Z" fill="#1e1796"/></g><g filter="url(#h)" transform="translate(-.003 .004)"><path data-name="Rectangle 555" d="M368.82 128.36H248.339V7.879A120.481 120.481 0 0 1 368.82 128.36Z" fill="#f0f5ff"/></g><g filter="url(#i)" transform="translate(-.003 .004)"><path data-name="Rectangle 553" d="M728.47 128.36H607.989V7.879A120.481 120.481 0 0 1 728.47 128.36Z" fill="#f0f5ff"/></g><g filter="url(#j)" transform="translate(-.003 .004)"><path data-name="Rectangle 551" d="M487.5 128.36v120.481H367.019A120.481 120.481 0 0 1 487.5 128.36Z" fill="#b4c7ff"/></g><g filter="url(#k)" transform="translate(-.003 .004)"><path data-name="Rectangle 530" d="M248.08 249.22v120.481H127.599A120.481 120.481 0 0 1 248.08 249.22Z" fill="#f0f5ff"/></g><g filter="url(#l)" transform="translate(-.003 .004)"><path data-name="Rectangle 557" d="M248.08 7.5v120.481H127.599A120.481 120.481 0 0 1 248.08 7.5Z" fill="#b4c7ff"/></g></g></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="763.047" height="760.026" viewBox="0 0 763.047 760.026"><defs><filter id="Union_10" x="243.046" y="240.025" width="520" height="520" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-sm"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-sm"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_621" x="304.666" y="300.231" width="395.725" height="395.725" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-2"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-2"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_632" x="149.674" y="0" width="107.754" height="118.682" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-3"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-3"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_633" x="149.674" y="288.272" width="107.754" height="116.773" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-4"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-4"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_635" x="0" y="149.6" width="118.428" height="107.754" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-5"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-5"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_636" x="288.018" y="149.6" width="116.862" height="107.754" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-6"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-6"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_622" x="63.674" y="63.682" width="279.59" height="279.591" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-7"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-7"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_634" x="122.259" y="122.513" width="162.296" height="162.296" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-8"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-8"/><feComposite in="SourceGraphic"/></filter></defs><g id="illustration-dsw2" transform="translate(-232.826 -2800.974)" style="isolation:isolate"><g transform="translate(232.83 2800.97)" filter="url(#Union_10)"><path id="Union_10-2" data-name="Union 10" d="M5091.5-31v-63.1a179.468 179.468 0 0 1-68.609-28.534l-44.7 44.7-45.255-45.255 44.434-44.433a179.529 179.529 0 0 1-29.477-68.878H4886v-64h60.817a179.377 179.377 0 0 1 28.107-71.321l-41.99-41.99 45.255-45.254 41.183 41.182A179.529 179.529 0 0 1 5091.5-448.9V-506h64v56.566a179.473 179.473 0 0 1 73.378 30.3l39.933-39.933 45.254 45.255-40.2 40.2a179.427 179.427 0 0 1 29.319 73.108H5361v64h-58.892a179.558 179.558 0 0 1-30.726 70.628l42.682 42.683-45.254 45.255-43.49-43.49a179.38 179.38 0 0 1-69.82 27.862V-31Z" transform="rotate(-90 3182.54 2425.99)" fill="#1e1796"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_621)"><rect id="Rectangle_621-2" data-name="Rectangle 621" width="248" height="248" rx="124" transform="rotate(45 -127.698 742.366)" fill="#d4e2ff"/></g><g id="Group_110" data-name="Group 110" transform="translate(136.594 77.536)" fill="#1e1796"><path id="Rectangle_603" data-name="Rectangle 603" transform="translate(576.5 3180)" d="M0 0h32v32H0z"/><path id="Rectangle_607" data-name="Rectangle 607" transform="translate(544.5 3180)" d="M0 0h32v32H0z"/><path id="Rectangle_606" data-name="Rectangle 606" transform="translate(576.5 3148)" d="M0 0h32v32H0z"/><path id="Rectangle_604" data-name="Rectangle 604" transform="translate(576.5 3212)" d="M0 0h32v32H0z"/><path id="Rectangle_605" data-name="Rectangle 605" transform="translate(576.5 3244)" d="M0 0h32v32H0z"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_632)"><path id="Rectangle_632-2" data-name="Rectangle 632" transform="translate(157.17 7.5)" fill="#b4c7ff" d="M0 0h62.754v73.682H0z"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_633)"><path id="Rectangle_633-2" data-name="Rectangle 633" transform="translate(157.17 295.77)" fill="#b4c7ff" d="M0 0h62.754v71.773H0z"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_635)"><path id="Rectangle_635-2" data-name="Rectangle 635" transform="rotate(-90 113.675 106.175)" fill="#b4c7ff" d="M0 0h62.754v73.428H0z"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_636)"><path id="Rectangle_636-2" data-name="Rectangle 636" transform="rotate(-90 257.685 -37.835)" fill="#b4c7ff" d="M0 0h62.754v71.862H0z"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_622)"><rect id="Rectangle_622-2" data-name="Rectangle 622" width="234.59" height="234.591" rx="117.295" transform="translate(71.17 71.18)" fill="#f0f5ff"/></g><g transform="translate(232.83 2800.97)" filter="url(#Rectangle_634)"><rect id="Rectangle_634-2" data-name="Rectangle 634" width="117.296" height="117.296" rx="58.648" transform="translate(129.76 130.01)" fill="#b4c7ff"/></g></g></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="342.112" height="401.763" viewBox="0 0 342.112 401.763"><defs><filter id="Union_2" x="177.525" y="0" width="164.588" height="164.588" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur"/><feComposite in="SourceGraphic"/></filter><filter id="Union_1" x="0" y="59.294" width="164.588" height="164.588" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-2"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-2"/><feComposite in="SourceGraphic"/></filter><filter id="Union_3" x="0" y="237.175" width="164.588" height="164.588" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-3"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-3"/><feComposite in="SourceGraphic"/></filter><filter id="Union_4" x="118.588" y="237.175" width="164.587" height="164.588" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-4"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-4"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_244" x="177.942" y="148.735" width="74.647" height="74.647" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-5"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-5"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_245" x="177.942" y="119.088" width="74.647" height="74.647" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-6"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-6"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_246" x="148.295" y="119.088" width="74.647" height="74.647" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-7"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-7"/><feComposite in="SourceGraphic"/></filter><filter id="Rectangle_247" x="148.296" y="148.735" width="74.647" height="74.647" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-8"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-8"/><feComposite in="SourceGraphic"/></filter><filter id="Union_7" x="118.149" y="177.881" width="164.587" height="105.294" filterUnits="userSpaceOnUse"><feOffset dx="15" dy="15"/><feGaussianBlur stdDeviation="7.5" result="blur-9"/><feFlood flood-opacity=".149"/><feComposite operator="in" in2="blur-9"/><feComposite in="SourceGraphic"/></filter></defs><g id="illustration-paro2" transform="translate(8 8)" style="mix-blend-mode:normal;isolation:isolate"><g transform="translate(-8 -8)" filter="url(#Union_2)"><path id="Union_2-2" data-name="Union 2" d="M59.294 88.941H29.647a29.647 29.647 0 0 1 29.647-29.647H0A59.294 59.294 0 0 1 59.294 0a59.294 59.294 0 0 1 59.294 59.294H59.294a29.647 29.647 0 1 1 0 59.294Zm-29.647 0h29.647v29.647a29.647 29.647 0 0 1-29.647-29.647Z" transform="rotate(180 152.055 63.295)" fill="#b4c7ff" stroke="rgba(0,0,0,0)" stroke-width="1"/></g><g transform="translate(-8 -8)" filter="url(#Union_1)"><path id="Union_1-2" data-name="Union 1" d="M59.294 88.941V59.294a29.647 29.647 0 1 1 0 59.294Zm-29.647 0h29.647v29.647a29.647 29.647 0 0 1-29.647-29.647Zm0 0a29.647 29.647 0 0 1 29.647-29.647v29.647ZM59.294 0h59.294v59.294A59.294 59.294 0 0 1 59.294 0ZM0 0h59.294A59.294 59.294 0 0 1 0 59.294Z" transform="rotate(180 63.295 92.94)" fill="#f0f5ff" stroke="rgba(0,0,0,0)" stroke-width="1"/></g><g transform="translate(-8 -8)" filter="url(#Union_3)"><path id="Union_3-2" data-name="Union 3" d="M59.294 88.941H29.647a29.647 29.647 0 0 1 29.647-29.647H0V0h118.588v59.294H59.294a29.647 29.647 0 1 1 0 59.294Zm-29.647 0h29.647v29.647a29.647 29.647 0 0 1-29.647-29.647Z" transform="rotate(180 63.295 181.88)" fill="#b4c7ff" stroke="rgba(0,0,0,0)" stroke-width="1"/></g><g transform="translate(-8 -8)" filter="url(#Union_4)"><path id="Union_4-2" data-name="Union 4" d="M59.293 118.588a29.646 29.646 0 0 1-29.646-29.647h29.647V59.294a29.647 29.647 0 0 1 29.647 29.647 29.646 29.646 0 0 1-29.646 29.647ZM29.647 88.941a29.647 29.647 0 0 1 29.647-29.647v29.647ZM59.293.223A59.293 59.293 0 0 1 0 59.294V0h118.587v59.294A59.293 59.293 0 0 1 59.293.223Z" transform="rotate(180 122.585 181.88)" fill="#f0f5ff" stroke="rgba(0,0,0,0)" stroke-width="1"/></g><g id="Group_313" data-name="Group 313"><g filter="url(#Rectangle_244)" transform="translate(-8.001 -8.002)"><path id="Rectangle_244-2" data-name="Rectangle 244" d="M0 0h29.647A29.647 29.647 0 0 1 0 29.647V0Z" transform="translate(185.44 156.23)" fill="#1e1796"/></g><g filter="url(#Rectangle_245)" transform="translate(-8.001 -8.002)"><path id="Rectangle_245-2" data-name="Rectangle 245" d="M29.647 0v29.647H0A29.647 29.647 0 0 1 29.647 0Z" transform="rotate(90 44.25 170.84)" fill="#1e1796"/></g><g filter="url(#Rectangle_246)" transform="translate(-8.001 -8.002)"><path id="Rectangle_246-2" data-name="Rectangle 246" d="M29.647 0v29.647H0A29.647 29.647 0 0 1 29.647 0Z" transform="translate(155.8 126.59)" fill="#1e1796"/></g><g filter="url(#Rectangle_247)" transform="translate(-8.001 -8.002)"><path id="Rectangle_247-2" data-name="Rectangle 247" d="M29.647 0v29.647H0A29.647 29.647 0 0 1 29.647 0Z" transform="rotate(-90 170.84 15.04)" fill="#1e1796"/></g><g filter="url(#Union_7)" transform="translate(-8.001 -8.002)"><path id="Union_7-2" data-name="Union 7" d="M0 0h118.587a59.292 59.292 0 0 1-59.293 59.293A59.293 59.293 0 0 1 0 0Z" transform="rotate(180 122.37 122.585)" fill="#1e1796" stroke="rgba(0,0,0,0)" stroke-width="1"/></g></g></g></svg>',
];

const projects = ref([]);
const grid = useGrid('tailwind');

// Computed
const gridRows = computed(() => {
  let projectsPerLine = 1;

  if (grid.md) {
    projectsPerLine = 2;
  }

  if (grid.lg) {
    projectsPerLine = 3;
  }

  const projectsLines = Math.ceil(projects.value.length / projectsPerLine);

  console.log(projectsLines);

  return (projectsLines * 7) + 1;
});

onMounted(async() => {
  projects.value = await useApi.get(`/items/projects?limit=25&fields[]=id&fields[]=title&fields[]=state&fields[]=subtitle&sort[]=id&page=1&deep={"translations":{"_filter":{"languages_code":{"_eq":"${useI18n()?.locale?.value}"}}}}`)
    .then((response) => response.data)
    .catch((error) => {
      console.error(error);
      return [];
    });
});
</script>
